{% extends "news/base.html"%}

{% block content %}
<div>
    <div id="showmain">
        {%csrf_token%}
        {% if articles %}
        {% for c in categories %}
        <div id=" {{c.name}}">
            <h2>{{c.name}}</h2>
            <br>
            {% for a in c.articles.all %}
            <div id="{{a.id}}">
                <h3>{{a.title}}</h3>
                <p>{{a.pub_Date}}</p>
                <p>{{a.body}}</p>
                <div id="{{a.id}}">
                    {%if loggedin%}
                    {%if user in a.likes.all %}
                    <a id="" class="likeArticle" name="like-button"> Unlike</a>
                    <a class="comment-button">Comment</a>
                    {%else%}
                    <a id="" class="likeArticle" name="like-button"> Like</a>
                    <a class="comment-button">Comment</a>
                    {%endif%}
                    {%endif%}
                    <div class="comments">
                        <h3>Comments:</h3>
                        {%if a.comments.exists %}
                        {%for com in a.comments.all%}
                        <div class="comment" id="{{com.id}}">
                            <p>{{com.author.username}} posted</p>
                            <p>{{com.text}}</p>
                            {%if com.author.username == user.username %}
                            <a class="deleteComment">delete</a>
                            <a class="editComment">edit</a>
                        </div>
                        {%endif%}

                        {%if com.replies.exists%}
                        <div class="replies">

                            {%for rep in com.replies.all %}
                            <div class="reply" id="{{rep.id}}">
                                <p>{{rep.author.username}} replied</p>
                                <p>{{rep.text}}</p>
                                {%if rep.author.username == user.username %}
                                <a class="deleteReply">delete</a>
                                <a class="editReply">edit</a>
                                {%endif%}
                            </div>
                            {%endfor%}

                            <div class="form-group replyform">
                                <label for="replybody">reply:</label><br />
                                <textarea id="replybody" placeholder="Enter your reply here" name="reply" rows="4" cols="50">
                                </textarea>
                                <br />
                                <button class="submitReply"> Reply</button>
                            </div>
                        </div>
                        {%endif%}
                        <br />
                        {%endfor%}
                        {%endif%}

                    </div>
                    <div class="form-group commentform">
                        <label for="commentbody"></label><br />
                        <textarea id="commentbody" name="comment" rows="4" cols="50">
                                </textarea>
                        <br />
                        <button class="submitComment">Add Comment</button>
                    </div>
                </div>
                <br>
            </div>
            {% endfor %}
            <br>
        </div>
        {% endfor %}
        {% else %}
        <p>No articles are available.</p>
        {% endif %}

    </div>
</div>

    {% endblock %}

